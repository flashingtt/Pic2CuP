2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Current SDK version is 0.17.2
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Configure stats pid to 12359
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Loading settings from /home/jumpserver/.config/wandb/settings
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Loading settings from /home/jumpserver/yxt/cir/tmp/Pic2CuP/wandb/settings
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'src/main.py', 'program_abspath': '/home/jumpserver/yxt/cir/tmp/Pic2CuP/src/main.py', 'program': '/home/jumpserver/yxt/cir/tmp/Pic2CuP/src/main.py'}
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_init.py:_log_setup():520] Logging user logs to /home/jumpserver/yxt/cir/tmp/Pic2CuP/wandb/run-20240622_215534-2iigohfd/logs/debug.log
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_init.py:_log_setup():521] Logging internal logs to /home/jumpserver/yxt/cir/tmp/Pic2CuP/wandb/run-20240622_215534-2iigohfd/logs/debug-internal.log
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_init.py:init():560] calling init triggers
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_init.py:init():567] wandb.init called with sweep_config: {}
config: {'time_suffix': True, 'train_data': '/mnt/vdb/yxt/huggingface/cc3m_01122022/cc/Train_GCC-training_output.csv', 'val_data': None, 'prompts': None, 'retrieval_data': None, 'demo_out': 'demo', 'source_data': None, 'target_data': None, 'target_pad': False, 'query_file': None, 'eval_mode': 'coco', 'middle_dim': 512, 'droprate': 0.1, 'n_layer': 2, 'dataset_type': 'auto', 'dataset_type_val': 'auto', 'csv_separator': '\t', 'csv_img_key': 'filepath', 'csv_caption_key': 'title', 'imagenet_val': None, 'imagenet_v2': None, 'logs': './logs/', 'name': 'lr=0.0001_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-06-22-13-55-09', 'workers': 8, 'batch_size': 1024, 'epochs': 30, 'lr': 0.0001, 'beta1': 0.9, 'beta2': 0.98, 'eps': 1e-06, 'wd': 0.1, 'warmup': 10000, 'use_bn_sync': False, 'use_debiased_sampler': False, 'use_prefix': False, 'gpu': 0, 'skip_scheduler': False, 'save_frequency': 1, 'save_most_recent': False, 'zeroshot_frequency': 2, 'regression_frequency': 2, 'resume': None, 'precision': 'amp', 'model': 'ViT-L/14', 'openai_pretrained': True, 'dist_url': 'tcp://127.0.0.1:6100', 'dist_backend': 'nccl', 'skip_aggregate': False, 'report_to': 'wandb', 'wandb_notes': '', 'C': 3.16, 'debug': False, 'copy_codebase': False, 'dp': False, 'multigpu': None, 'distributed': True, 'f': 'im2text', 'n_ctx': 3, 'n_img': 1, 'prompt': 'learnable', 'meta_prompt': True, 'transform': 'clippad', 'target_ratio': 1.25, 'no_val': False, 'eval_interval': 1, 'saved_model_path': None, 'val_result_txt': None, 'date': '20240227', 'visual_best': False, 'visual_compared': False, 'best_visual_path': None, 'pseudo_only': True, 'aggregate': True, 'log_path': './logs/lr=0.0001_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-06-22-13-55-09/out.log', 'ngpus_per_node': 4, 'wandb': True, 'tensorboard': False, 'tensorboard_path': '', 'checkpoint_path': './logs/lr=0.0001_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-06-22-13-55-09/checkpoints', 'log_level': 20, 'world_size': 4, 'rank': 0, 'save_logs': True, 'train_sz': 2704098}
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_init.py:init():610] starting backend
2024-06-22 21:55:34,851 INFO    MainThread:12359 [wandb_init.py:init():614] setting up manager
2024-06-22 21:55:34,852 INFO    MainThread:12359 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-06-22 21:55:34,853 INFO    MainThread:12359 [wandb_init.py:init():622] backend started and connected
2024-06-22 21:55:34,856 INFO    MainThread:12359 [wandb_init.py:init():711] updated telemetry
2024-06-22 21:55:34,962 INFO    MainThread:12359 [wandb_init.py:init():744] communicating run to backend with 90.0 second timeout
2024-06-22 21:55:36,161 INFO    MainThread:12359 [wandb_run.py:_on_init():2402] communicating current version
2024-06-22 21:55:40,023 INFO    MainThread:12359 [wandb_run.py:_on_init():2411] got version response 
2024-06-22 21:55:40,023 INFO    MainThread:12359 [wandb_init.py:init():795] starting run threads in backend
2024-06-22 21:55:42,010 INFO    MainThread:12359 [wandb_run.py:_console_start():2380] atexit reg
2024-06-22 21:55:42,010 INFO    MainThread:12359 [wandb_run.py:_redirect():2235] redirect: wrap_raw
2024-06-22 21:55:42,010 INFO    MainThread:12359 [wandb_run.py:_redirect():2300] Wrapping output streams.
2024-06-22 21:55:42,010 INFO    MainThread:12359 [wandb_run.py:_redirect():2325] Redirects installed.
2024-06-22 21:55:42,011 INFO    MainThread:12359 [wandb_init.py:init():838] run started, returning control to user process
2024-06-22 21:56:34,305 WARNING MsgRouterThr:12359 [router.py:message_loop():77] message_loop has been closed
